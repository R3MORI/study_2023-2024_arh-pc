**РОССИЙСКИЙ УНИВЕРСИТЕТ ДРУЖБЫ НАРОДОВ** 

**Факультет физико-математических и естественных наук  Кафедра прикладной информатики и теории вероятностей** 

` `**ОТЧЕТ**  

**ПО ЛАБОРАТОРНОЙ РАБОТЕ №6** 

` `***дисциплина: Архитектура компьютеров и операционные системы*** 

Студент: Ян Роман Алексеевич Группа:    НПИбд-02-23 

Содержание 

**1  Цель работы** 

Освоение арифметических инструкций языка ассемблера NASM. 

**2  Выполнение лабораторной работы** 

1. **Символьные и численные данные в NASM** 

Создадим каталог для программ лабораторной работы № 6, перейдем в него и создадим файл *lab6-1.asm*: 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.001.png)

*Рис 2.1.1: Создание каталога и файла .asm* 

Рассмотрим примеры программ вывода символьных и численных значений. Программы будут выводить значения записанные в регистр eax. 

Введем в файлe *lab6-1.asm* текст программы из листинга 6.1. В данной программе в регистр eax записывается символ 6 (mov eax,‘6’), в регистр ebx символ 4 (mov ebx,‘4’). Далее к значению в регистре eax прибавляем значение регистра ebx (add eax,ebx, результат сложения запишется в регистр eax). Далее выводим результат. Так как для работы функции *sprintLF* в регистр eax должен быть записан адрес, необходимо использовать дополнительную переменную. Для этого запишем значение регистра eax в переменную *buf1 (mov [buf1],eax)*, а затем запишем адрес переменной *buf1* в регистр *eax (mov eax,buf1)* и вызовем функцию sprintLF. 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.002.png)

*Рис 2.1.2: Демонстрация текста программы в файле* Скопируем *in\_out.asm* из каталога *lab05* в *lab06* 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.003.png)

*Рис 2.1.3: Копирование файла для программы* Создадим исполняемый файл и запустим его 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.004.png)

*Рис 2.1.4: Создание исполняемого файла и проверка работы* 

В данном случае при выводе значения регистра eax мы ожидаем увидеть число 10. Однако результатом будет символ j. Это происходит потому, что код символа 6 равен 00110110 в двоичном представлении (или 54 в десятичном представлении), а код символа 4 – 00110100 (52). Команда add eax,ebx запишет в регистр eax сумму кодов – 01101010 (106), что в свою очередь является кодом символа j (см. таблицу ASCII в приложении). 

Далее изменим текст программы и вместо символов, запишем в регистры числа. Исправим текст программы следующим образом: 

- mov eax,‘6’ 
- mov ebx,‘4’ 

на строки 

- mov eax,6 
- mov ebx,4 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.005.png)

*Рис 2.1.5: Демонстрация изменения программы* Cоздадим исполняемый файл и запустим его. 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.006.png)

*Рис 2.1.6: Создание исполняемого файла и проверка работы* 

Как и в предыдущем случае при исполнении программы мы не получим число 10. В данном случае выводится символ с кодом 10. Пользуясь таблицей ASCII определим какому символу соответствует код 10, это *LF, |n*. Который не отображается на выводе Как отмечалось выше, для работы с числами в файле in\_out.asm реализованы подпрограммы для преобразования ASCII символов в числа и обратно. Преобразуем текст программы из Листинга 6.1 с использованием этих функций. 

Создадим файл *lab6-2.asm* в каталоге *~/work/arch-pc/lab06* и введем в него текст программы из листинга 6.2. 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.007.png)

*Рис 2.1.7: Создание файла* 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.008.png)

*Рис 2.1.8: Демонстрация программы* Создадим исполняемый файл и запустим его. 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.009.png)

*Рис 2.1.9: Создание исполняемого файла и проверка работы* 

В результате работы программы мы получим число 106. В данном случае, как и в первом, команда add складывает коды символов ‘6’ и ‘4’ (54+52=106). Однако, в отличии от программы из листинга 6.1, функция *iprintLF* позволяет вывести число, а не символ, кодом которого является это число. 

Аналогично предыдущему примеру изменим символы на числа. Заменим строки 

- mov eax,‘6’ 
- mov ebx,‘4’ 

на строки 

- mov eax,6 
- mov ebx,4 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.010.png)

*Рис 2.1.10: Демонстрация измененной программы* 

Создадим исполняемый файл и запустим его. 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.011.png)

*Рис 2.1.11: Создание исполняемого файла и проверка работы* 

В результате мы получили число 10 

Заменим функцию *iprintLF* на *iprint*. Создадим исполняемый файл и запустим его. 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.012.png)

*Рис 2.1.12: Создание исполняемого файла и проверка работы* 

В результате также мы получили число 10, но в случае *iprint* число выведено без красной строки 

2. **Выполнение арифметических операций в NASM** 

В качестве примера выполнения арифметических операций в NASM приведем программу вычисления арифметического выражения f(x)= (5 \* 2 + 3)/3. 

Создадим файл *lab6-3.asm* в каталоге ~/work/arch-pc/lab06: 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.013.png)

*Рис 2.2.1: Создание файла* 

Внимательно изучим текст программы из листинга 6.3 и введем в *lab6-3.asm*. 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.014.jpeg)

*Рис 2.2.2: Демонстрация программы* Создадим исполняемый файл и запустим его. 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.015.png)

*Рис 2.2.3: Создание исполняемого файла и проверка работы* 

Изменим текст программы для вычисления выражения f(x) = (4 \* 6 + 2)/5. 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.016.jpeg)

*Рис 2.2.4: Демонстрация измененной программы* Создадим исполняемый файл и проверим его работу. 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.017.png)

*Рис 2.2.5: Создание исполняемого файла и проверка работы* 

В качестве другого примера рассмотрим программу вычисления варианта задания по номеру студенческого билета, работающую по следующему алгоритму: 

- вывести запрос на введение № студенческого билета 
- вычислить номер варианта по формуле: (Sn mod 20) + 1, где Sn – номер студенческого билета (В данном случае a mod b - это остаток от деления a на b). 
- вывести на экран номер варианта. 

В данном случае число, над которым необходимо проводить арифметические операции, вводится с клавиатуры. Как отмечалось выше ввод с клавиатуры осуществляется в символьном виде и для корректной работы арифметических операций в NASM символы необходимо преобразовать в числа. Для этого может быть использована функция atoi из файла in\_out.asm. 

Создадим файл *variant.asm* в каталоге ~/work/arch-pc/lab06: 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.018.png)

*Рис 2.2.6: Создание файла* 

Внимательно изучим текст программы из листинга 6.4 и введем в файл variant.asm. 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.019.jpeg)

*Рис 2.2.7: Демонстрация программы* Создадим исполняемый файл и запустим его. 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.020.png)

*Рис 2.2.8: Создание исполняемого файла и проверка работы* 

3. **Вопросы** 

Включите в отчет по выполнению лабораторной работы ответы на следующие вопросы: 

1) Какие строки листинга 6.4 отвечают за вывод на экран сообщения ‘Ваш вариант:’? 

call sprint mov eax,rem 

2) Для чего используется следующие инструкции? mov ecx, x - перемещает адрес вводимой строки в ecx 

mov edx, 80 - записывает длину строки в регистр edx 

call sread- вызывает подпрограммы, которые обеспечивают ввод сообщения с помощью клавиатуры 

3) Для чего используется инструкция “call atoi”? 

Она используется для вызыва подпрограммы, которая преобразует ASII код символа в целое число, записывая его в результат регитсра “eax” 

4) Какие строки листинга 6.4 отвечают за вычисления варианта? 

xor edx, edx ; обнуление ebx для div 

mov ebx, 10 ; ebx=10 

div ebx ; eax = eax/10, edx - остаток от деления nc edc ; edx=edx+1 

5) В какой регистр записывается остаток от деления при выполнении инструкции “div ebx”? 

При div ebx остаток от деления записывается в edx 

6) Для чего используется инструкция “inc edx”? 

inc edx увелиивает значение регистра edx на +1 

7) Какие строки листинга 6.4 отвечают за вывод на экран результата вычислений? 

mov eax, edx 

call iprintLF 

**3  Самостоятельная работа** 

*Задание№1 Написать программу вычисления выражения y=f(x). Программа должна выводить выражение для вычисления, выводить запрос на ввод значения x, вычислять заданное выражение в зависимости от введенного x, выводить результат вычислений. Вид функции f(x) выбрать из таблицы 6.3 вариантов заданий в соответствии с номером полученным при выполнении лабораторной работы. Создайте исполняемый файл и проверьте его работу для значений x1 и x2 из 6.3.* *При выполнении задания преобразовывать (упрощать) выражения для f(x) нельзя. При выполнении деления в качестве результата можно использовать только целую часть от деления и не учитывать остаток (т.е. 5 : 2 = 2)* 

Создадим новый файл для задания и напишем программу для f(x)=(10+2x)/3 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.021.png)

*Рис 3.1.1: Создание файла* 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.022.jpeg)

*Рис 3.1.2: Демонстрация программы* Проверим программу 

![](Aspose.Words.d7f8a140-efa7-45d5-adae-ffb03da2c32d.023.png)

*Рис 3.1.3: Проверка программы* 

Загрузим все файлы на github по окончании лаб. работы 

**4  Выводы** 

Я освоил арифметические инструкции языка ассемблера NASM и приобрел практические навыки по работе с арифметикой в NASM. 
